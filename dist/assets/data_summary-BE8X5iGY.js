import{d as G,r as n,i as Q,D as X,b as r,G as Z,c as q,o as L,f as c,K as A,e as a,w as t,k as N,ao as H,Z as J,h as u,ap as O,j as W,y as Y,X as ee,E as k,_ as ae}from"./index-D-5IU2IW.js";const le={class:"data-summary-container"},te={class:"header"},oe={class:"action-bar"},ne={class:"pagination"},se={class:"dialog-footer"},re=G({__name:"data_summary",setup(de){const f=n([]),v=n(!1),p=n(""),x=n("ProductionDataSummary"),g=n(10),C=n(0),m=n(!1),h=n("新建数据"),s=n({id:"",product:"",testName:"",dataLink:""}),V=n(),b=async()=>{v.value=!0;try{const o=await ee("/api/db/read/document",{db_name:x.value,document_name:"ProductionData2025",limit:100});f.value=o.all_docs,C.value=o.all_docs}catch(o){k.error("获取数据失败: "+o.message)}finally{v.value=!1}},w=()=>{},z=()=>{p.value=""},D=o=>{g.value=o,b()},S=o=>{},P=()=>{h.value="新建数据",s.value={id:"",product:"",testName:"",dataLink:""},m.value=!0},U=o=>{},T=()=>{V.value.validate(async o=>{if(o)try{k.success(s.value.id?"更新成功":"创建成功"),m.value=!1,b()}catch(e){k.error("操作失败: "+e.message)}})},B=o=>{},E=Q(()=>p.value?f.value.filter(o=>o.Production.toLowerCase().includes(p.value.toLowerCase())):f.value);return X(()=>{b()}),(o,e)=>{const d=r("el-button"),_=r("el-input"),i=r("el-table-column"),I=r("el-link"),$=r("el-table"),K=r("el-pagination"),y=r("el-form-item"),j=r("el-form"),M=r("el-dialog"),R=Z("loading");return L(),q("div",le,[c("div",te,[e[8]||(e[8]=c("h2",null,"数据汇总表",-1)),c("div",oe,[a(_,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=l=>p.value=l),placeholder:"按产品名搜索",clearable:"",style:{width:"300px","margin-right":"20px"},onClear:z,onKeyup:J(w,["enter"])},{append:t(()=>[a(d,{icon:N(H),onClick:w},null,8,["icon"])]),_:1},8,["modelValue"]),a(d,{type:"primary",onClick:P,icon:N(O)},{default:t(()=>e[7]||(e[7]=[u("新建数据")])),_:1,__:[7]},8,["icon"])])]),A((L(),W($,{data:E.value,border:"",stripe:"",style:{width:"100%"}},{default:t(()=>[a(i,{prop:"Production",label:"产品名",width:"180",sortable:""}),a(i,{prop:"TestName",label:"测试名",width:"320"}),a(i,{prop:"NPI",label:"NPI",width:"120"}),a(i,{prop:"Link",label:"数据链接"},{default:t(({row:l})=>[a(I,{type:"primary",href:l.Link,target:"_blank"},{default:t(()=>[u(Y(l.LinkLabel),1)]),_:2},1032,["href"])]),_:1}),a(i,{prop:"CreateTime",label:"创建时间",width:"180",sortable:""}),a(i,{label:"操作",width:"150",fixed:"right"},{default:t(({row:l})=>[a(d,{size:"small",onClick:F=>U(l)},{default:t(()=>e[9]||(e[9]=[u("编辑")])),_:2,__:[9]},1032,["onClick"]),a(d,{size:"small",type:"danger",onClick:F=>B(l)},{default:t(()=>e[10]||(e[10]=[u("删除")])),_:2,__:[10]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[R,v.value]]),c("div",ne,[a(K,{"page-size":g.value,"onUpdate:pageSize":e[1]||(e[1]=l=>g.value=l),"page-sizes":[10,20,50,100],total:C.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:D,onCurrentChange:S},null,8,["page-size","total"])]),a(M,{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=l=>m.value=l),title:h.value,width:"50%"},{footer:t(()=>[c("span",se,[a(d,{onClick:e[5]||(e[5]=l=>m.value=!1)},{default:t(()=>e[11]||(e[11]=[u("取消")])),_:1,__:[11]}),a(d,{type:"primary",onClick:T},{default:t(()=>e[12]||(e[12]=[u("确认")])),_:1,__:[12]})])]),default:t(()=>[a(j,{model:s.value,ref_key:"formRef",ref:V,"label-width":"100px"},{default:t(()=>[a(y,{label:"产品名",prop:"product"},{default:t(()=>[a(_,{modelValue:s.value.product,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.product=l),placeholder:"请输入产品名"},null,8,["modelValue"])]),_:1}),a(y,{label:"测试名",prop:"testName"},{default:t(()=>[a(_,{modelValue:s.value.testName,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.testName=l),placeholder:"请输入测试名"},null,8,["modelValue"])]),_:1}),a(y,{label:"数据链接",prop:"dataLink"},{default:t(()=>[a(_,{modelValue:s.value.dataLink,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.dataLink=l),placeholder:"请输入数据链接"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ue=ae(re,[["__scopeId","data-v-a57e1dfe"]]);export{ue as default};
